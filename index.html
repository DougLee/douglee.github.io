<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Dougle Lee' BLog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Dougle Lee' BLog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dougle Lee' BLog">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> Dougle Lee' BLog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Dougle Lee' BLog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">随心随性，万法同宗</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/29/ZooKeeper源码学习-1/" itemprop="url">
                  ZooKeeper源码学习(1) Eclipse编译ZooKeeper源码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-29T15:22:53+08:00" content="2015-12-29">
              2015-12-29
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/12/29/ZooKeeper源码学习-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/12/29/ZooKeeper源码学习-1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>接下来的工作可能要用到zookeeper，学习一下zookeeper的源码，是为记录。<br>这是第一篇，在Eclipse中编译zookeeper源码</p>
<h2 id="安装Ant">安装Ant</h2><ol>
<li>下载Ant， 地址：<a href="http://ant.apache.org/bindownload.cgi" target="_blank" rel="external">http://ant.apache.org/bindownload.cgi</a></li>
<li>解压到指定目录，并设置ANT_HOME(解压的路径)和PATH(%ANT_HOME%\bin)</li>
<li>打开cmd，输入ant -version，出现版本信息说明安装Ant成功</li>
</ol>
<h2 id="用ant编译Zookeeper源码">用ant编译Zookeeper源码</h2><p>ZooKeeper代码<a href="https://github.com/apache/zookeeper" target="_blank" rel="external">下载地址</a>。</p>
<p>解压代码，切换到ZooKeeper源码根目录下面，输入命令：ant eclipse编译。</p>
<p>编译之前可以改一下ivysettings.xml中的maven镜像路径，改为国内的镜像地址如：<a href="http://maven.oschina.net/content/groups/public/，加快下编译速度，如下图" target="_blank" rel="external">http://maven.oschina.net/content/groups/public/，加快下编译速度，如下图</a><br><img src="/image/zookeeper1/1.jpg" alt=""></p>
<h2 id="导入编译后的ZooKeeper工程">导入编译后的ZooKeeper工程</h2><p>ant编译完成之后，打开Eclipse，选择import，类型是现有的Eclipse工程。<br><img src="/image/zookeeper1/2.png" alt=""></p>
<p>点击完成，发现源码有几处错误<br><img src="/image/zookeeper1/3.jpg" alt=""></p>
<p>该错误跟JDK版本有关，需要jdk6，</p>
<p>在导入的ZooKeeper工程右键=&gt;properties=&gt;Java Compiler,将从名牌里尔 compliance level 切换到1.6：<br><img src="/image/zookeeper1/4.jpg" alt=""></p>
<p>这样代码上的错误消失。可以开始学习ZooKeeper源码了。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/02/Python中使用xlrd操作Excel/" itemprop="url">
                  Python中使用xlrd操作Excel
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-12-02T10:17:18+08:00" content="2015-12-02">
              2015-12-02
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/12/02/Python中使用xlrd操作Excel/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/12/02/Python中使用xlrd操作Excel/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>xlrd应该算是Python下比较常用的操作Excel的包了。前段时间用到了，这里做个记录。</p>
<h2 id="1_安装xlrd">1 安装xlrd</h2><p>使用pip安装xlrd包。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install xlrd -i http://pypi.douban.com/simple</span><br></pre></td></tr></table></figure>
<h2 id="2_基本用法">2 基本用法</h2>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/24/Java中String、Date和Timestamp之间的转换/" itemprop="url">
                  Java中String、Date和Timestamp之间的转换
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-09-24T14:18:47+08:00" content="2015-09-24">
              2015-09-24
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/09/24/Java中String、Date和Timestamp之间的转换/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/24/Java中String、Date和Timestamp之间的转换/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>记录一下Java中String和Date、Timestamp之间的转换。下文的代码可能会用到一些包。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Timestamp;</span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br></pre></td></tr></table></figure>
<h3 id="String和Date之间的转换">String和Date之间的转换</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Date date = <span class="keyword">new</span> Date();</span><br><span class="line">SimpleDateFormat dateformat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//Date to String</span></span><br><span class="line">String a1 = dateformat.format(date);</span><br><span class="line">System.out.println(<span class="string">"Date to String："</span> + a1);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//String to Date</span></span><br><span class="line">    Date d = dateformat.parse(<span class="string">"2015-09-24 10:48:06"</span>);</span><br><span class="line">    System.out.println(<span class="string">"String to Date: "</span> + d);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="String和Timestamp之间的转换">String和Timestamp之间的转换</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Timestamp ts = <span class="keyword">new</span> Timestamp(System.currentTimeMillis());</span><br><span class="line">System.out.println(<span class="string">"Timestamp: "</span> + ts);</span><br><span class="line"></span><br><span class="line"><span class="comment">// String to Timestamp</span></span><br><span class="line">String tsStr = <span class="string">"2011-05-09 11:49:45"</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    ts = Timestamp.valueOf(tsStr);</span><br><span class="line">    System.out.println(<span class="string">"String to Timestamp: "</span> + ts);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Timestamp to String</span></span><br><span class="line">String tsStr1 = <span class="string">""</span>;</span><br><span class="line">DateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy/MM/dd HH:mm:ss"</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 方法一</span></span><br><span class="line">    tsStr1 = sdf.format(ts);</span><br><span class="line">    System.out.println(<span class="string">"Timestamp to String1: "</span> + tsStr);</span><br><span class="line">    <span class="comment">// 方法二</span></span><br><span class="line">    tsStr1 = ts.toString();</span><br><span class="line">    System.out.println(<span class="string">"Timestamp to String2: "</span> + tsStr);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Date和Timestamp之间的转换">Date和Timestamp之间的转换</h3><p>Timestamp继承自Date</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Timestamp ts = <span class="keyword">new</span> Timestamp(System.currentTimeMillis());</span><br><span class="line">System.out.println(<span class="string">"Timestamp: "</span> + ts);</span><br><span class="line"><span class="comment">// Date to Timestamp (father to child)</span></span><br><span class="line">Timestamp ts1 = <span class="keyword">new</span> Timestamp(date.getTime());</span><br><span class="line">System.out.println(<span class="string">"Date to Timestamp: "</span> + ts1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Timestamp to Date</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    date = ts;</span><br><span class="line">    System.out.println(<span class="string">"Timestamp to Date: "</span> + date);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/14/Python模块学习之re/" itemprop="url">
                  Python模块学习之re
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-09-14T14:59:54+08:00" content="2015-09-14">
              2015-09-14
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/09/14/Python模块学习之re/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/14/Python模块学习之re/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>正则表达式是开发中比较重要的一个技能，可以说几乎上是没有不用做字符串处理的程序。</p>
<h2 id="正则表达式基础">正则表达式基础</h2><h3 id="基本用法">基本用法</h3><p>下图列出了一些基本的正则表达式语法：<br><img src="/image/python_Re/1.png" alt="pic"></p>
<h3 id="贪婪模式">贪婪模式</h3><p>在Python里默认数量词是贪婪的，总是尝试匹配尽可能多的字符。</p>
<h3 id="转义字符">转义字符</h3><p>Python在正则表达式里使用”\”作为转义字符，这就可能造成反斜杠困扰。假如你需要匹配文本中的字符”\”，那么使用编程语言表示的正则表达式里将需要4个反斜杠”\\“：前两个和后两个分别用于在编程语言里转义成反斜杠，转换成两个反斜杠后再在正则表达式里转义成一个反斜杠。Python里的原生字符串很好地解决了这个问题，这个例子中的正则表达式可以使用r”\“表示。同样，匹配一个数字的”\d”可以写成r”\d”。有了原生字符串，你再也不用担心是不是漏写了反斜杠，写出来的表达式也更直观。</p>
<h2 id="Re模块">Re模块</h2><h3 id="初次见面">初次见面</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">pattern = <span class="string">r"a"</span></span><br><span class="line">s = <span class="string">"abcde"</span></span><br><span class="line"></span><br><span class="line">print(re.match(pattern, s))</span><br></pre></td></tr></table></figure>
<h3 id="re-compile(pattern,_falgs=0)">re.compile(pattern, falgs=0)</h3><p>这个方法是Pattern类的工厂方法，将字符串形式的正则表达式编译为Pattern对象。第二个参数是匹配模式</p>
<h3 id="re模块常用函数">re模块常用函数</h3><h4 id="re-search(pattern,_string,_flags=0)">re.search(pattern, string, flags=0)</h4><p>re.search函数会在字符串内查找模式匹配，只找到第一个匹配然后返回，如果字符串没有匹配，则返回None。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s = <span class="string">'1111-1119'</span></span><br><span class="line">pattern = <span class="string">r'(\d+)-(\d+)'</span></span><br><span class="line"></span><br><span class="line">result = re.search(pattern, s, re.I)</span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    print(result.group(<span class="number">0</span>))</span><br><span class="line">    print(result.group(<span class="number">1</span>))</span><br><span class="line">    print(result.group(<span class="number">2</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'Not match'</span>)</span><br></pre></td></tr></table></figure></p>
<h4 id="re-match(pattern,_string,_flags=0)">re.match(pattern, string, flags=0)</h4><p>尝试从字符串的开始匹配一个模式，也可以说是匹配第一个单词</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s = <span class="string">'abc1111-1119'</span></span><br><span class="line">pattern = <span class="string">r'(\d+)-(\d+)$'</span></span><br><span class="line"></span><br><span class="line">result = re.match(pattern, s, re.I)</span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    print(result.group(<span class="number">0</span>))</span><br><span class="line">    print(result.group(<span class="number">1</span>))</span><br><span class="line">    print(result.group(<span class="number">2</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'Not match'</span>)</span><br><span class="line"><span class="comment"># 结果为Not match</span></span><br></pre></td></tr></table></figure>
<p><strong>match只检测是不是在字符串的开始位置匹配，search会扫描整个字符串查找匹配</strong>。</p>
<h4 id="re-findall(pattern,_string,_flags=0)">re.findall(pattern, string, flags=0)</h4><p>搜索string，以列表形式返回全部能匹配的子串,若没有匹配则返回None。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s = <span class="string">'abc1111-1119'</span></span><br><span class="line">pattern = <span class="string">r'(\d+)-(\d+)$'</span></span><br><span class="line"></span><br><span class="line">t = re.findall(pattern, s)</span><br><span class="line">print(t)</span><br><span class="line"><span class="comment"># result: [('1111', '1119')]</span></span><br></pre></td></tr></table></figure>
<h4 id="re-spit(pattern,_string,_maxsplit=0,_flags=0)">re.spit(pattern, string, maxsplit=0, flags=0)</h4><p>分割字符串</p>
<ul>
<li>pattern: 规则  </li>
<li>string：要分割的字符串</li>
<li>maxsplit：分割的次数，默认为0,即表示全部分割</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s = <span class="string">'a1b2c3d4'</span></span><br><span class="line">pattern = <span class="string">r'\d+'</span></span><br><span class="line"></span><br><span class="line">print(re.split(pattern, s, <span class="number">1</span>))</span><br><span class="line"><span class="comment"># ['a', 'b2c3d4']</span></span><br><span class="line">print(re.split(pattern, s))</span><br><span class="line"><span class="comment">#['a', 'b', 'c', 'd', '']</span></span><br></pre></td></tr></table></figure>
<h4 id="re-sub(pattern,_repl,_string,_count=0,_flags=0)">re.sub(pattern, repl, string, count=0, flags=0)</h4><p>替换字符串的匹配项</p>
<ul>
<li>pattern: 规则 </li>
<li>repl：替换后的字符串 </li>
<li>string：要替换的字符串</li>
<li>maxsplit：匹配的次数，默认为0，全部匹配</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s = <span class="string">'a1b2c3d4'</span></span><br><span class="line">pattern = <span class="string">r'\d+'</span></span><br><span class="line"></span><br><span class="line">print(re.sub(pattern, <span class="string">'|'</span>, s, <span class="number">1</span>))</span><br><span class="line"><span class="comment"># a|b2c3d4</span></span><br><span class="line">print(re.sub(pattern, <span class="string">'|'</span>, s))</span><br><span class="line"><span class="comment">#a|b|c|d|</span></span><br></pre></td></tr></table></figure>
<h4 id="re-subn(pattern,_repl,_string,_count=0,_flags=0)">re.subn(pattern, repl, string, count=0, flags=0)</h4><p>返回替换后的字符串以及替换次数</p>
<p>参数同sub</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s = <span class="string">'a1b2c3d4'</span></span><br><span class="line">pattern = <span class="string">r'\d+'</span></span><br><span class="line"></span><br><span class="line">print(re.subn(pattern, <span class="string">'|'</span>, s, <span class="number">1</span>))</span><br><span class="line"><span class="comment"># ('a|b2c3d4', 1)</span></span><br><span class="line">print(re.subn(pattern, <span class="string">'|'</span>, s))</span><br><span class="line"><span class="comment">#('a|b|c|d|', 4)</span></span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/10/scrapy使用小结/" itemprop="url">
                  scrapy使用小结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-09-10T15:08:46+08:00" content="2015-09-10">
              2015-09-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/09/10/scrapy使用小结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/10/scrapy使用小结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>这篇文章来总结一下初次使用scrapy的经验。</p>
<h3 id="简介">简介</h3><p>scrapy是基于python的一个强大的爬虫框架，用于抓取web站点并从页面中提取结构化的数据。</p>
<p>scrapy使用<a href="http://twistedmatrix.com/trac/" target="_blank" rel="external">Twisted</a>这个异步网络库来处理网络通讯，包含了各种中间件接口，可以灵活的完成各种需求。整体架构如下图所示：<br><img src="/image/scrapy/40238622_1.png" alt="pic"></p>
<h3 id="安装">安装</h3><p>可以使用pip安装scrapy，安装的时候scrapy需要的一些依赖包也会一并安装。这里使用豆瓣的py镜像，这样安装速度会比较快。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install scrapy -i http://pypi.douban.com/simple</span><br></pre></td></tr></table></figure>
<h3 id="第一个爬虫">第一个爬虫</h3><p>接下来开始编写第一个爬虫，以抓取知乎用户为例。</p>
<h4 id="新建项目">新建项目</h4><p>首先，需要定义一个scrapy项目，运行命令：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy startproject zhihuspider</span><br></pre></td></tr></table></figure>
<p>会创建一个zhihuspider项目，包含如下内容：<br><img src="/image/scrapy/1.jpg" alt="pic"></p>
<p>其中：</p>
<ul>
<li>scrapy.cfg: 项目的配置文件</li>
<li>zhihuSpider/: 该项目的python模块，本爬虫的代码会存放在此处。</li>
<li>zhihuSpider/items.py: 项目中的item文件，用来定义存储数据的item结构。</li>
<li>zhihuSpider/pipelines.py: 项目中的pipelines文件，可编写一些pipeline类，用来操作抓取到的item，比如存入数据库，或者保存json文件</li>
<li>zhihuSpider/settings.py: 项目的设置文件。</li>
<li>zhihuSpider/spiders/: 放置spider代码的目录</li>
</ul>
<h4 id="定义Item数据">定义Item数据</h4><p>Item是保存抓取到数据的容器。类似于ORM，可创建一个<strong>scrapy.Item</strong>类，并且定义类型为<strong>scrapy.Field</strong>的类属性来定义一个Item。</p>
<p>分析下知乎用户中一些我们想要抓取的信息，这里假设只抓取用户名，用户ID，可用户的链接。item.py文件如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZhihuspiderItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    <span class="comment"># name = scrapy.Field()</span></span><br><span class="line">    name = scrapy.Field()</span><br><span class="line">    userID = scrapy.Field()</span><br><span class="line">    link = scrapy.Field()</span><br></pre></td></tr></table></figure>
<h4 id="编写spider">编写spider</h4><p>创建一个spider，需要继承<strong>scrapy.Spider</strong>类，且定义三个属性：</p>
<ul>
<li>name: 用于区分Spider，相当于该爬虫的唯一标识</li>
<li>start_urls: 包含Spider在启动时进行爬取的url列表</li>
<li>parse()：Spider的一个方法。每一个抓取完的url生成的<strong>Response</strong>对象会作为参数传递给该方法。该方法可以解析返回的数据，提取数据，以及生成需要进一步处理的URL的<strong>Request</strong>对象。</li>
</ul>
<p>在zhihuSpider/spiders下新建一个peopleSpider.py文件，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> zhihuSpider.items <span class="keyword">import</span> ZhihuspiderItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeopleSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">"zhihu"</span></span><br><span class="line">    start_urls = [</span><br><span class="line">        <span class="string">'http://www.zhihu.com/people/Douglee'</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span> </span><br><span class="line">        item = ZhihuspiderItem()</span><br><span class="line">        item[<span class="string">'link'</span>] =  response.url</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>
<h4 id="开始抓取">开始抓取</h4><p>运行抓取命令scrapy crawl #name, 如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy crawl zhihu</span><br></pre></td></tr></table></figure>
<p>可以从shell窗口看到item的信息，如下图：</p>
<p><img src="/image/scrapy/2.jpg" alt="pic"></p>
<h3 id="使用正则和xpath解析数据">使用正则和xpath解析数据</h3><p>上边的parse()方法只有link，没有name和userID，现在来解析这两个属性。</p>
<p>通过观察可以发现，userID可以从url中获取，这里可以定义一个正则，用正则来获取userID。</p>
<p>而name可以从抓取到的页面中用xpth分析出来，我经常使用Chrome浏览器，用Chrome可以很方便的取出来xpath，两个方法：</p>
<ol>
<li><p>按F12 使用Chrome的develop tools，选中页面上需要的数据，右键copy xpath，如图：<br><img src="/image/scrapy/3.png" alt="pic"></p>
</li>
<li><p>安装一个Xpath helper插件，可以更方便的取出xpath。</p>
</li>
</ol>
<p>这里需添加两个引用，完整的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scrapy.selector <span class="keyword">import</span> Selector</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> zhihuSpider.items <span class="keyword">import</span> ZhihuspiderItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeopleSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">"zhihu"</span></span><br><span class="line">    start_urls = [</span><br><span class="line">        <span class="string">'http://www.zhihu.com/people/Douglee'</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        nameXpath = <span class="string">r"//div[@class='title-section ellipsis']/span[@class='name']/text()"</span></span><br><span class="line">        pattern = <span class="string">r'http://www.zhihu.com/people/([\w+-]+)$'</span></span><br><span class="line"></span><br><span class="line">        item = ZhihuspiderItem()</span><br><span class="line">        item[<span class="string">'name'</span>] = Selector(response).xpath(nameXpath).extract()[<span class="number">0</span>]</span><br><span class="line">        item[<span class="string">'userID'</span>] = re.search(pattern, response.url).group(<span class="number">1</span>)</span><br><span class="line">        item[<span class="string">'link'</span>] =  response.url</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>
<p>抓取的shell窗口信息：<br><img src="/image/scrapy/4.jpg" alt="pic"></p>
<p>至此，就完成了一个简单的爬虫。</p>
<h3 id="References">References</h3><ol>
<li>官方文档：<a href="http://scrapy.readthedocs.org/en/latest/" target="_blank" rel="external">http://scrapy.readthedocs.org/en/latest/</a></li>
<li>中文文档：<a href="https://scrapy-chs.readthedocs.org/zh_CN/0.24/" target="_blank" rel="external">https://scrapy-chs.readthedocs.org/zh_CN/0.24/</a></li>
</ol>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/08/31/NHibernate使用小结/" itemprop="url">
                  NHibernate使用小结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-08-31T14:27:06+08:00" content="2015-08-31">
              2015-08-31
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/31/NHibernate使用小结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/31/NHibernate使用小结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h3 id="NHibernate简单介绍">NHibernate简单介绍</h3><p>NHibernate是一个面向.Net环境的对象/关系数据库映射工具。主要用来把对象模型表示的对象映射到基于SQL的关系模型数据结构中去。NHibernate是基于.Net的Hibernate实现。</p>
<p>NHibernate不仅仅管理.Net类到数据库表的映射，还提供数据查询和获取的方法。NHibernate的目标是解放开发者通常的数据持久化相关的编程任务。</p>
<h3 id="NHibernate下载">NHibernate下载</h3><p>初次使用NHibernate，可以先到<a href="http://sourceforge.net/projects/nhibernate/" target="_blank" rel="external">这里</a>下载最新的NHibernate版本。如果使用VS的话，可以在Nuget中搜索NHibernate下载安装。</p>
<h3 id="NHibernate初次使用">NHibernate初次使用</h3><h6 id="1-_新建项目，添加NHibernate引用">1. 新建项目，添加NHibernate引用</h6><p>引用从官网下载的dll文件，或者在VS中可以使用Nuget下载安装NHibernate，安装完之后会有两个引用：NHibernate.dll和IesiCollections.dll。这里以Nuget安装为例。</p>
<h5 id="2-_新建数据库及使用的表">2. 新建数据库及使用的表</h5><p>实例使用一个简单的数据库school，有两个表，Class和Student<br><img src="/image/NHibernate使用小结/db.jpg" alt="pic"></p>
<h5 id="3-_添加NHibernate相关的配置文件">3. 添加NHibernate相关的配置文件</h5><p>项目中需要添加一个hibernate.cfg.xml配置文件，文件中包含数据库的驱动信息，数据库的链接字符串等信息。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span><br><span class="line">This template was written to work with NHibernate.Test.</span><br><span class="line">Copy the template to your NHibernate.Test project folder and rename it in hibernate.cfg.xml and change it </span><br><span class="line">for your own use before compile tests in VisualStudio.</span><br><span class="line">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- This is the ByteFX.Data.dll provider for MySql --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">hibernate-configuration</span>  <span class="attribute">xmlns</span>=<span class="value">"urn:nhibernate-configuration-2.2"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">session-factory</span> <span class="attribute">name</span>=<span class="value">"NHibernate.Test"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"connection.driver_class"</span>&gt;</span>NHibernate.Driver.MySqlDataDriver<span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"connection.connection_string"</span>&gt;</span></span><br><span class="line">      Database=school;Data Source=127.0.0.1;User Id='cnki';Password='';charset='utf8';pooling=true;Convert Zero Datetime=True; Allow Zero Datetime=True</span><br><span class="line">    <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"dialect"</span>&gt;</span>NHibernate.Dialect.MySQLDialect<span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在项目根目录下的package/NHibernate.x.xxx/ConfigurationTemplates文件夹下已经有了对应各个数据库的配置模板，如MSServer、Mysql、Oracle等。</p>
<p>需要注意的是，这个xml配置文件需要设置下“如果较新则复制”。</p>
<h5 id="4-_编写Model以及对应的Mapping文件">4. 编写Model以及对应的Mapping文件</h5><p>编写Grade和Student两个model，以及对应的Mapping文件。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Grade</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">virtual</span> Grade Grade &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Mapping文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">hibernate-mapping</span> <span class="attribute">xmlns</span>=<span class="value">"urn:nhibernate-mapping-2.2"</span> <span class="attribute">assembly</span>=<span class="value">"NHibernate.Demo"</span> <span class="attribute">namespace</span>=<span class="value">"NHibernate.Demo.Models"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">class</span> <span class="attribute">name</span>=<span class="value">"Grade"</span> <span class="attribute">table</span>=<span class="value">"Class"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">id</span> <span class="attribute">name</span>=<span class="value">"ID"</span> <span class="attribute">type</span>=<span class="value">"Int32"</span>  <span class="attribute">column</span> =<span class="value">"id"</span> <span class="attribute">access</span>=<span class="value">"property"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span> =<span class="value">"Name"</span> <span class="attribute">column</span>=<span class="value">"Name"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">hibernate-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">hibernate-mapping</span> <span class="attribute">xmlns</span>=<span class="value">"urn:nhibernate-mapping-2.2"</span> <span class="attribute">assembly</span>=<span class="value">"NHibernate.Demo"</span> <span class="attribute">namespace</span>=<span class="value">"NHibernate.Demo.Models"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">class</span> <span class="attribute">name</span>=<span class="value">"Student"</span> <span class="attribute">table</span>=<span class="value">"Student"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">id</span> <span class="attribute">name</span>=<span class="value">"ID"</span> <span class="attribute">type</span>=<span class="value">"Int32"</span>  <span class="attribute">column</span> =<span class="value">"id"</span> <span class="attribute">access</span>=<span class="value">"property"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">id</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span> =<span class="value">"Name"</span> <span class="attribute">column</span>=<span class="value">"Name"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">one-to-one</span> <span class="attribute">name</span>=<span class="value">"Grade"</span> <span class="attribute">class</span>=<span class="value">"Grade"</span> <span class="attribute">constrained</span>=<span class="value">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里需要注意在hibernate.cfg.xml文件中添加model和Mapping文件的引用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">mapping</span> <span class="attribute">assembly</span>=<span class="value">"NHibernate.Demo"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="5-_编写业务逻辑代码CRUD">5. 编写业务逻辑代码CRUD</h5><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GradeService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="preprocessor">#<span class="keyword">region</span> NHibernate 封装</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="keyword">object</span> lockObj = <span class="keyword">new</span> <span class="keyword">object</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">static</span> ISessionFactory factory = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> ISessionFactory Factory</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (factory == <span class="keyword">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">lock</span> (lockObj)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (factory == <span class="keyword">null</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">var</span> cfg = <span class="keyword">new</span> Configuration();</span><br><span class="line">                            factory = cfg.Configure().BuildSessionFactory();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> factory;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ISession <span class="title">GetCurrentSession</span><span class="params">()</span></span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Factory.GetCurrentSession();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ISession <span class="title">OpenSession</span><span class="params">()</span></span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Factory.OpenSession();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="preprocessor">#<span class="keyword">endregion</span> NHibernate 封装</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> ISession sessionEX = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">GradeService</span><span class="params">()</span></span><br><span class="line">        </span>&#123;</span><br><span class="line">            sessionEX = <span class="keyword">this</span>.OpenSession();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;Grade&gt; <span class="title">Finds</span><span class="params">()</span></span><br><span class="line">        </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> criteria = sessionEX.CreateCriteria(<span class="keyword">typeof</span>(Grade));</span><br><span class="line">            <span class="keyword">var</span> result1 = criteria.List&lt;Grade&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//return result1.ToList();</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> sql = <span class="string">"select * from class"</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> query = sessionEX.CreateSQLQuery(sql).AddEntity(<span class="keyword">typeof</span>(Grade));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = query.List&lt;Grade&gt;().ToList();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这样第一个使用NHibernate的小实例就完成了。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/08/07/Windows下Python开发环境搭建/" itemprop="url">
                  Windows下Python开发环境搭建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-08-07T00:02:51+08:00" content="2015-08-07">
              2015-08-07
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/07/Windows下Python开发环境搭建/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/07/Windows下Python开发环境搭建/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="Windows下兼容两个Python环境">Windows下兼容两个Python环境</h2><h3 id="python2-x_pip的安装">python2.x pip的安装</h3><h2 id="MySQLdb的安装">MySQLdb的安装</h2>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/07/31/Nutch-中为Webpage模型添加自定义字段/" itemprop="url">
                  Nutch 中为Webpage模型添加自定义字段
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-07-31T16:33:18+08:00" content="2015-07-31">
              2015-07-31
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/07/31/Nutch-中为Webpage模型添加自定义字段/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/07/31/Nutch-中为Webpage模型添加自定义字段/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>近来一直在研究nutch，今天想在默认的webpage表中增加几个自定义字段，折腾了一天，终于加入成功了。<br>我的环境是win7 + Nutch2.2.1 + mysql5.6.12。</p>
<p>一句话，新增自定义字段主要需要修改两个文件：<strong>webpage.java</strong>和<strong>gora-sql-mapping</strong>.xml（这里我使用的数据库是mysql，如果是hbase的话修改gora-hbase-mapping.xml文件）。</p>
<p>第一，找到webpage.class在webpage中的_SCHEMA Field以及新字段对应的属性做相应的修改。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">public static final Schema _SCHEMA = Schema</span><br><span class="line">        .parse("&#123;\"type\":\"record\",\"name\":\"WebPage\",\"namespace\":\"org.apache.nutch.storage\",\"fields\":[&#123;\e\":\"baseUrl\",\"type\":\"string\"&#125;,&#123;\"name\":\"status\",\"type\":\"int\"&#125;,&#123;\"name\":\"fetchTime\",\"type\long\"&#125;,&#123;\"name\":\"prevFetchTime\",\"type\":\"long\"&#125;,&#123;\"name\":\"fetchInterval\",\"type\":\"int\"&#125;,&#123;\"nam\"retriesSinceFetch\",\"type\":\"int\"&#125;,&#123;\"name\":\"modifiedTime\",\"type\":\"long\"&#125;,&#123;\"name\":\"prevModifime\",\"type\":\"long\"&#125;,&#123;\"name\":\"protocolStatus\",\"type\":&#123;\"type\":\"record\",\"name\":\"ProtocolStat,\"fields\":[&#123;\"name\":\"code\",\"type\":\"int\"&#125;,&#123;\"name\":\"args\",\"type\":&#123;\"type\":\"array\",\"items\"tring\"&#125;&#125;,&#123;\"name\":\"lastModified\",\"type\":\"long\"&#125;]&#125;&#125;,&#123;\"name\":\"content\",\"type\":\"bytes\"&#125;,&#123;\"nam\"contentType\",\"type\":\"string\"&#125;,&#123;\"name\":\"prevSignature\",\"type\":\"bytes\"&#125;,&#123;\"name\":\"signature\type\":\"bytes\"&#125;,&#123;\"name\":\"title\",\"type\":\"string\"&#125;,&#123;\"name\":\"text\",\"type\":\"string\"&#125;,&#123;\"name\parseStatus\",\"type\":&#123;\"type\":\"record\",\"name\":\"ParseStatus\",\"fields\":[&#123;\"name\":\"majorCode\",\"\":\"int\"&#125;,&#123;\"name\":\"minorCode\",\"type\":\"int\"&#125;,&#123;\"name\":\"args\",\"type\":&#123;\"type\":\"array\",\"ite:\"string\"&#125;&#125;]&#125;&#125;,&#123;\"name\":\"score\",\"type\":\"float\"&#125;,&#123;\"name\":\"reprUrl\",\"type\":\"string\"&#125;,&#123;\"name"headers\",\"type\":&#123;\"type\":\"map\",\"values\":\"string\"&#125;&#125;,&#123;\"name\":\"outlinks\",\"type\":&#123;\"type\":\"m,\"values\":\"string\"&#125;&#125;,&#123;\"name\":\"inlinks\",\"type\":&#123;\"type\":\"map\",\"values\":\"string\"&#125;&#125;,&#123;\"name\"arkers\",\"type\":&#123;\"type\":\"map\",\"values\":\"string\"&#125;&#125;,&#123;\"name\":\"metadata\",\"type\":&#123;\"type\":\"map"values\":\"bytes\"&#125;&#125;,&#123;\"name\":\"batchId\",\"type\":\"string\"&#125;,&#123;\"name\":\"body\",\"type\":\"bytes\&#123;\"name\":\"ISSN\",\"type\":\"string\"&#125;]&#125;</span><br><span class="line">public static enum Field &#123;</span><br><span class="line">    BASE_URL(0, "baseUrl"), STATUS(1, "status"), FETCH_TIME(2, "fetchTime"), PREV_FETCH_TIME(</span><br><span class="line">            3, "prevFetchTime"), FETCH_INTERVAL(4, "fetchInterval"), RETRIES_SINCE_FETCH(</span><br><span class="line">            5, "retriesSinceFetch"), MODIFIED_TIME(6, "modifiedTime"), PREV_MODIFIED_TIME(</span><br><span class="line">            7, "prevModifiedTime"), PROTOCOL_STATUS(8, "protocolStatus"), CONTENT(</span><br><span class="line">            9, "content"), CONTENT_TYPE(10, "contentType"), PREV_SIGNATURE(</span><br><span class="line">            11, "prevSignature"), SIGNATURE(12, "signature"), TITLE(13,</span><br><span class="line">            "title"), TEXT(14, "text"), PARSE_STATUS(15, "parseStatus"), SCORE(</span><br><span class="line">            16, "score"), REPR_URL(17, "reprUrl"), HEADERS(18, "headers"), OUTLINKS(</span><br><span class="line">            19, "outlinks"), INLINKS(20, "inlinks"), MARKERS(21, "markers"), METADATA(</span><br><span class="line">            22, "metadata"), BATCH_ID(23, "batchId"), BODY(24, "body"), ISSN(25, "ISSN");</span><br><span class="line">    private int index;</span><br><span class="line">    private String na</span><br><span class="line">    Field(int index, String name) &#123;</span><br><span class="line">        this.index = index;</span><br><span class="line">        this.name = name;</span><br><span class="line">  </span><br><span class="line">    public int getIndex() &#123;</span><br><span class="line">        return index;</span><br><span class="line">  </span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">  </span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">public static final String[] _ALL_FIELDS = &#123; "baseUrl", "status",</span><br><span class="line">        "fetchTime", "prevFetchTime", "fetchInterval", "retriesSinceFetch",</span><br><span class="line">        "modifiedTime", "prevModifiedTime", "protocolStatus", "content",</span><br><span class="line">        "contentType", "prevSignature", "signature", "title", "text",</span><br><span class="line">        "parseStatus", "score", "reprUrl", "headers", "outlinks",</span><br><span class="line">        "inlinks", "markers", "metadata", "batchId", "body", "issn" &#125;;</span><br><span class="line">static &#123;</span><br><span class="line">    PersistentBase.registerFields(WebPage.class, _ALL_FIELDS);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private Utf8 body;</span><br><span class="line">private String ISSN;</span><br><span class="line"></span><br><span class="line">public Utf8 getBody() &#123;</span><br><span class="line">    return (Utf8) get(24);</span><br><span class="line">&#125;</span><br><span class="line">public void setBody(Utf8 value) &#123;</span><br><span class="line">    put(24, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public String getISSN() &#123;</span><br><span class="line">    return (String) get(25);</span><br><span class="line">&#125;</span><br><span class="line">public void setISSN(String value) &#123;</span><br><span class="line">    put(25, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以及Object get()和set()中添加新字段的相关信息。</p>
<p>第二 在gora-sql-mapping文件中添加想要增加的字段的Mapping关系，如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">field</span> <span class="attribute">name</span>=<span class="value">"body"</span> <span class="attribute">column</span>=<span class="value">"body"</span> <span class="attribute">length</span>=<span class="value">"32000"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">field</span> <span class="attribute">name</span>=<span class="value">"ISSN"</span> <span class="attribute">column</span>=<span class="value">"ISSN"</span> <span class="attribute">length</span>=<span class="value">"10"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上就可以直接运行nutch了，如果有报错信息的话可以调试查看gora-sql-0.2.jar中的SqlStore.java中的createSchema()方法，这个方法中会生成有建表语句，根据错误信息做相应的修改即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createSchema</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!schemaExists()) &#123;</span><br><span class="line">    log.info(<span class="string">"creating schema: "</span> + sqlTable.getAbsoluteName());</span><br><span class="line">    CreateTableQuery query = <span class="keyword">new</span> CreateTableQuery(sqlTable, <span class="keyword">true</span>);</span><br><span class="line">    setColumnConstraintForQuery(query, primaryColumn);</span><br><span class="line">    <span class="keyword">for</span>(Column column : mapping.getFields().values()) &#123;</span><br><span class="line">      setColumnConstraintForQuery(query, column);</span><br><span class="line">    &#125;</span><br><span class="line">    PreparedStatement statement = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      statement = connection.prepareStatement(query.validate().toString());</span><br><span class="line">      statement.executeUpdate();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> IOException(ex);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      SqlUtils.close(statement);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>EOF</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/07/30/Hadoop1-2-1伪分布式配置说明/" itemprop="url">
                  Hadoop1.2.1伪分布式配置说明
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-07-30T13:58:37+08:00" content="2015-07-30">
              2015-07-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/07/30/Hadoop1-2-1伪分布式配置说明/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/07/30/Hadoop1-2-1伪分布式配置说明/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>这篇文章记录一下伪分布式的配置。伪分布式较之单机版多了几处配置。环境依然是Ubuntu14.04</p>
<ol>
<li>前提条件：<br> a. JDK安装并配置<br> b. 安装有ssh<pre><code><span class="number">1</span>). sudo apt-get install openssh-server
<span class="number">2</span>). ssh-kengen -t dsa -<span class="constant">P</span> <span class="string">''</span> -f ~<span class="regexp">/.ssh/id</span>_dsa
<span class="number">3</span>). cat ~<span class="regexp">/.ssh/id</span>_dsa.pub <span class="prompt">&gt;&gt; </span>~<span class="regexp">/.ssh/authorized</span>_keys
<span class="number">4</span>). ssh localhost
</code></pre></li>
<li>在hadoop根目录下创建几个目录<br> a. mkdir tmp<br> b. mkdir hdfs<br> c. mkdir hdfs/name<br> d. mkdir hdfs/data</li>
<li>修改配置文件，需要修改conf/文件夹下的core-site.xml hdfs-site.xml和mapred-site.xml三个配置文件<br> a. core-site.xml<br>   <img src="/image/Hadoop1-2-1伪分布式配置说明/core-site.png" alt="core-site.xml"><br> b. hdfs-site.xml<br>   <img src="/image/Hadoop1-2-1伪分布式配置说明/hdfs-site.png" alt="hdfs-site.xml"><br> c. mapred-site.xml<br>   <img src="/image/Hadoop1-2-1伪分布式配置说明/mapred-site.png" alt="mapred-site.xml"></li>
<li>格式化hdfs： hadoop namenode -format</li>
<li>data文件夹权限设置： sudo chmod 755 /hdfs/data</li>
<li>启动hadoop: start-all.sh</li>
<li>jps命令，查看hadoop是否启动成功，如果有6个进程则说明成功<br><img src="/image/Hadoop1-2-1伪分布式配置说明/status.png" alt="hadoop status"></li>
<li>检查运行状态：<br> a. <a href="http://localhost:50030" target="_blank" rel="external">http://localhost:50030</a>  -Hadoop管理界面<br> b. <a href="http://localhost:50060" target="_blank" rel="external">http://localhost:50060</a>  -Hadoop TaskTracker状态<br> c. <a href="http://localhost:50070" target="_blank" rel="external">http://localhost:50070</a>  -Hadoop DFS状态</li>
<li>至此hadoop已经配置完成，接下来运行wordcount任务体验一把<br> a. 在dfs中创建input文件夹：hadoop dfs -mkdir input<br> b. 将conf中的文件拷贝到dfs中的input：hadoop dfs -copyFromLocal conf/<em> input<br> c. 运行job：hadoop jar hadoop-example-1.2.1 jar wordcount input output<br> d. 查看输出信息： hadoop dfs -cat output/</em></li>
<li>参考<br><a href="http://blog.csdn.net/devtao/article/details/16105579" target="_blank" rel="external">http://blog.csdn.net/devtao/article/details/16105579</a></li>
</ol>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/07/29/Hadoop1-2-1单机版配置说明/" itemprop="url">
                  Hadoop1.2.1单机版配置说明
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-07-29T21:46:35+08:00" content="2015-07-29">
              2015-07-29
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/07/29/Hadoop1-2-1单机版配置说明/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/07/29/Hadoop1-2-1单机版配置说明/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>前端时间一直在研究Nutch，需要对Hadoop有所了解。之前没有接触过Hadoop，在这里把学习Hadoop的过程记录下来。</p>
<p>今天第一篇，Hadoop1.2.1单机版配置说明。</p>
<p>环境：Ubuntu14.04</p>
<ol>
<li>前提：JDK安装并设置。</li>
<li>下载hadoop.1.2.1.tar.gz。</li>
<li>例如在usr/locarl/下新建一个hadoop文件夹，将下载的hadoop放到这个文件夹下。</li>
<li>解压hadoop-1.2.1.tar.gz，命令 sudo tar -zxf hadoop-1.2.1.tar.gz。</li>
<li>修改hadoop环境变量：<br> a. 取得hadoop-1.2.1文件夹的读写权限：Sudo chown -R douglee hadoop-1.2.1<br> b. 修改hadoop-env.sh文件：sudo gedit hadoop-1.2.1/conf/hadoop-env.sh<br> c. 修改JAVA_HOME为本机的jdk安装地址即可</li>
<li>验证hadoop是否正常运行：<br> a. cd hadoop-1.2.1<br> b. Bin/hadoop version， 是否出来hadoop的相关版本信息</li>
<li>运行wordcount实例程序<br> a. 新建一个input文件夹：Mkdir input<br> b. 将conf下的文件复制到input下： cp conf/<em> input<br> c. 运行wordcount程序，将结果写入output：bin/hadoop jar hadoop-example-1.2.1.jar wordcount input output<br> d. Cat output/</em>  查看输出结果</li>
<li>参考：<a href="http://blog.csdn.net/wyswlp/article/details/10564847" target="_blank" rel="external">http://blog.csdn.net/wyswlp/article/details/10564847</a></li>
</ol>
<p>下一篇记录一下伪分布式的配置说明。</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/21/我常用的Sublime-Text插件/" itemprop="url">
                  我常用的Sublime Text插件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-04-21T21:26:39+08:00" content="2015-04-21">
              2015-04-21
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/21/我常用的Sublime-Text插件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/21/我常用的Sublime-Text插件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>Sublime Text是非常有逼格的一个编辑器，有各种丰富的插件，可以打造成顺手IDE，今天就总结一下我常用的一些插件。</p>
<p>今年四月份的时候刚刚抛弃了ST2，拥抱ST3~</p>
<h3 id="Package_Control">Package Control</h3><p>Package Control是用来安装各个插件的一个工具。安装方法如下：</p>
<p>按Ctrl + `，在弹出的框内粘贴如下一段代码，然后Enter，等待安装完成即可。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import urllib.request,os,hashlib; h = 'eb2297e1a458f27d836c04bb0cbaf282' + 'd0e7a3098092775ccb37ca9d6b2e4b7d'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); print('Error validating download (got %s instead of %s), please try manual install' % (dh, h)) if dh != h else open(os.path.join( ipp, pf), 'wb' ).write(by)</span><br></pre></td></tr></table></figure></p>
<p>待安装完成后按Ctrl + Shift + P,在弹出框内输入install找到Package Control:Install Package 功能项，进入，即可搜索安装需要安装的插件了</p>
<p>更多有关安装Package Control的信息，点击<a href="https://packagecontrol.io/installation" target="_blank" rel="external">这里</a></p>
<h3 id="Python_Anaconda">Python Anaconda</h3><p>开发Python的必备利器。</p>
<h3 id="Terminal">Terminal</h3><p>在Sublime Text中打开一个terminal终端，快捷键是 Ctrl + Shift + T</p>
<h3 id="JsFormat">JsFormat</h3><p>一个格式化JS代码的插件。</p>
<h3 id="Emmet">Emmet</h3><p>Sublime Text的Zen Coding插件。</p>
<p>用法：</p>
<ol>
<li>首先 Ctrl + Shift + P，输入sshtml，设置页面为html格式</li>
<li>输入html标签，如 html ，然后按tab键即可。</li>
<li>几种常用的Zen Coding写法：</li>
</ol>
<h3 id="HTML-CSS-JS_Prettify">HTML-CSS-JS Prettify</h3><p>格式还html css和js代码。<br>默认快捷键：<strong>Ctrl + Shift + H</strong>。或者右键选择“HTML/CSS/JS Prettify” -&gt; “Prettify Code”</p>
<h3 id="OmniMarkupPreviewer">OmniMarkupPreviewer</h3><p>刚开始使用，可以在浏览器中预览Markdown格式（Ctrl + Alt + O），可以导出到HTML格式，更多功能还在摸索。</p>
<h3 id="常用的快捷键">常用的快捷键</h3><p>Ctrl + B: build python代码<br>Ctrl + /: 注释代码<br>Ctrl + Shift + H：格式化html/css/js代码</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  


        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="http://tp2.sinaimg.cn/1703692505/180/5683784972/1" alt="douglee" itemprop="image"/>
          <p class="site-author-name" itemprop="name">douglee</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">11</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">6</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/douglee" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/daominlee/" target="_blank">
                  
                    <i class="fa fa-weibo"></i> Weibo
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">douglee</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"douglee"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     


    
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
